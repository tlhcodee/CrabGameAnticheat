using CAC.checks.events.impl;
using CAC.data.trackers;
using System;
using System.Collections.Generic;
using System.Text;

namespace CAC.checks.impl.exploit.fakelag
{
    public class FakeLagB() : Check("FakeLag", CheckLevel.B, "Checks for being able to hit while lagging", 5, 5)
    {
        public override void handleCombatTick(EventCombat e)
        {
            PositionTracker positionTracker = this.player.positionTracker;

            DateTime lastUpdated = positionTracker.lastUpdate;

            DateTime now = DateTime.Now;

            double difference = (now - lastUpdated).TotalMilliseconds;

            bool invalid = difference > 1000; // BRO IS NOT SENDING ANY POSITION PACKETS BUT STILL ABLE TO HIT??
                                             
            if(invalid && this.Buffer.increase() > 1)
            {
                this.fail();
            } else
            {
                this.Buffer.decrease();
            }

            base.handleCombatTick(e);
        }
    }
}
